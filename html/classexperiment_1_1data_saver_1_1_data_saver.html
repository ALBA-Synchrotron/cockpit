<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OMX Cockpit: experiment.dataSaver.DataSaver Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">OMX Cockpit
   &#160;<span id="projectnumber">.01</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>experiment</b></li><li class="navelem"><b>dataSaver</b></li><li class="navelem"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html">DataSaver</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classexperiment_1_1data_saver_1_1_data_saver-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">experiment.dataSaver.DataSaver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class simply records all data received during an experiment and saves it to disk in MRC format.  
 <a href="classexperiment_1_1data_saver_1_1_data_saver.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4684b9c9a06247e298697b4a7718605a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a4684b9c9a06247e298697b4a7718605a">__init__</a></td></tr>
<tr class="memitem:afa6d3a6545aae9b95d6e947e32de0c02"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#afa6d3a6545aae9b95d6e947e32de0c02">startCollecting</a></td></tr>
<tr class="memdesc:afa6d3a6545aae9b95d6e947e32de0c02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subscribe to the new-camera-image events for the cameras we care about.  <a href="#afa6d3a6545aae9b95d6e947e32de0c02"></a><br/></td></tr>
<tr class="memitem:a2189967aa67a999bb46a7883af6d51ca"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a2189967aa67a999bb46a7883af6d51ca">onAbort</a></td></tr>
<tr class="memdesc:a2189967aa67a999bb46a7883af6d51ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">User aborted; stop saving data.  <a href="#a2189967aa67a999bb46a7883af6d51ca"></a><br/></td></tr>
<tr class="memitem:ac898ee9fbc4511a5e8bfb76bac353dfc"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#ac898ee9fbc4511a5e8bfb76bac353dfc">executeAndSave</a></td></tr>
<tr class="memdesc:ac898ee9fbc4511a5e8bfb76bac353dfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait for the runThread to finish, then wait a bit longer in case some images are laggardly, before we close our filehandles.  <a href="#ac898ee9fbc4511a5e8bfb76bac353dfc"></a><br/></td></tr>
<tr class="memitem:a39e7bd46b7ae26a2bf2b64fb22719bc4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a39e7bd46b7ae26a2bf2b64fb22719bc4">cleanup</a></td></tr>
<tr class="memdesc:a39e7bd46b7ae26a2bf2b64fb22719bc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up once saving is completed.  <a href="#a39e7bd46b7ae26a2bf2b64fb22719bc4"></a><br/></td></tr>
<tr class="memitem:a33577b9366395c6aefcad609ad8d2b4b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a33577b9366395c6aefcad609ad8d2b4b">onImage</a></td></tr>
<tr class="memdesc:a33577b9366395c6aefcad609ad8d2b4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive new data, and add it to the queue.  <a href="#a33577b9366395c6aefcad609ad8d2b4b"></a><br/></td></tr>
<tr class="memitem:acceb6f5fe6708950dbd7886658814ccf"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#acceb6f5fe6708950dbd7886658814ccf">saveData</a></td></tr>
<tr class="memdesc:acceb6f5fe6708950dbd7886658814ccf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Continually poll our imageQueue and save data to the file.  <a href="#acceb6f5fe6708950dbd7886658814ccf"></a><br/></td></tr>
<tr class="memitem:a49e01a4c87b07ac71cb9c47e50c7d8e7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a49e01a4c87b07ac71cb9c47e50c7d8e7">writeImage</a></td></tr>
<tr class="memdesc:a49e01a4c87b07ac71cb9c47e50c7d8e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a single image to the file.  <a href="#a49e01a4c87b07ac71cb9c47e50c7d8e7"></a><br/></td></tr>
<tr class="memitem:a4b340b98619f048a957e5ed0188cb90f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a4b340b98619f048a957e5ed0188cb90f">getFilenames</a></td></tr>
<tr class="memdesc:a4b340b98619f048a957e5ed0188cb90f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a list of the filenames we are writing to.  <a href="#a4b340b98619f048a957e5ed0188cb90f"></a><br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:affb97365cc447a2a33f761b43671ef81"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="affb97365cc447a2a33f761b43671ef81"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>cameras</b></td></tr>
<tr class="memitem:a9a71a9bf75699ce616d09ef30a8e2ce6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9a71a9bf75699ce616d09ef30a8e2ce6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>numReps</b></td></tr>
<tr class="memitem:abcfdd51a1927bfd9af5446e18b4060cb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abcfdd51a1927bfd9af5446e18b4060cb"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>cameraToImagesPerRep</b></td></tr>
<tr class="memitem:a4cdef2ba690efd3e11cceec763c15393"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4cdef2ba690efd3e11cceec763c15393"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>cameraToIgnoredImageIndices</b></td></tr>
<tr class="memitem:aaad91ce3209dc0d1f72295037bd2a11d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaad91ce3209dc0d1f72295037bd2a11d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>runThread</b></td></tr>
<tr class="memitem:af09fa749c99a7ebe23cd2bdbb8df0a13"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#af09fa749c99a7ebe23cd2bdbb8df0a13">maxFilesize</a></td></tr>
<tr class="memdesc:af09fa749c99a7ebe23cd2bdbb8df0a13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum size, in megabytes, of each file generated.  <a href="#af09fa749c99a7ebe23cd2bdbb8df0a13"></a><br/></td></tr>
<tr class="memitem:ab82193dced20f0382317f7c0fb71da59"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab82193dced20f0382317f7c0fb71da59"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#ab82193dced20f0382317f7c0fb71da59">uniqueID</a></td></tr>
<tr class="memdesc:ab82193dced20f0382317f7c0fb71da59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unique ID for our instance. <br/></td></tr>
<tr class="memitem:a86c1e541acdb0be44eec93b6f69beb02"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a86c1e541acdb0be44eec93b6f69beb02"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>maxHeight</b></td></tr>
<tr class="memitem:abcfc9538377e03b0f95f3f0a2f382d84"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#abcfc9538377e03b0f95f3f0a2f382d84">cameraToIndex</a></td></tr>
<tr class="memdesc:abcfc9538377e03b0f95f3f0a2f382d84"><td class="mdescLeft">&#160;</td><td class="mdescRight">We need to establish a consistent ordering for cameras so that each image gets stored in the correct part of the file.  <a href="#abcfc9538377e03b0f95f3f0a2f382d84"></a><br/></td></tr>
<tr class="memitem:ac19ac0a539885106a5817c2612a3e29e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#ac19ac0a539885106a5817c2612a3e29e">cameraToImagesKeptPerRep</a></td></tr>
<tr class="memdesc:ac19ac0a539885106a5817c2612a3e29e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maps camera handlers to total images kept per rep.  <a href="#ac19ac0a539885106a5817c2612a3e29e"></a><br/></td></tr>
<tr class="memitem:ab5fc734a68e3e6ce2c63a000dfb83b5f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab5fc734a68e3e6ce2c63a000dfb83b5f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>maxWidth</b></td></tr>
<tr class="memitem:a8d514ddedfebf87322df7c11bcf2de74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a8d514ddedfebf87322df7c11bcf2de74">maxImagesPerRep</a></td></tr>
<tr class="memdesc:a8d514ddedfebf87322df7c11bcf2de74"><td class="mdescLeft">&#160;</td><td class="mdescRight">We need this for the upper bound on the array of data we write.  <a href="#a8d514ddedfebf87322df7c11bcf2de74"></a><br/></td></tr>
<tr class="memitem:a06c9c9250532566df07fea83be416b77"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a06c9c9250532566df07fea83be416b77">imageBytes</a></td></tr>
<tr class="memdesc:a06c9c9250532566df07fea83be416b77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bytes to allocate for each image in the file.  <a href="#a06c9c9250532566df07fea83be416b77"></a><br/></td></tr>
<tr class="memitem:a20ca42c4a45d7d9fae993d0de7f6f294"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a20ca42c4a45d7d9fae993d0de7f6f294">maxRepsPerFile</a></td></tr>
<tr class="memdesc:a20ca42c4a45d7d9fae993d0de7f6f294"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of timepoints per file, based on the above and self.maxFilesize.  <a href="#a20ca42c4a45d7d9fae993d0de7f6f294"></a><br/></td></tr>
<tr class="memitem:a8e0d45a680b312d5e0d245b09b340a69"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a8e0d45a680b312d5e0d245b09b340a69">doNeedToSplitFiles</a></td></tr>
<tr class="memdesc:a8e0d45a680b312d5e0d245b09b340a69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether or not we need to split the data into multiple files.  <a href="#a8e0d45a680b312d5e0d245b09b340a69"></a><br/></td></tr>
<tr class="memitem:aee88e2dddd15fd61e6826e082f89a868"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#aee88e2dddd15fd61e6826e082f89a868">indexToCamera</a></td></tr>
<tr class="memdesc:aee88e2dddd15fd61e6826e082f89a868"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maps ints to cameras; the ints represent the order in which the images are stored.  <a href="#aee88e2dddd15fd61e6826e082f89a868"></a><br/></td></tr>
<tr class="memitem:acfe9cb9b263e8746c2a17b62a2f477d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#acfe9cb9b263e8746c2a17b62a2f477d9">firstTimestamp</a></td></tr>
<tr class="memdesc:acfe9cb9b263e8746c2a17b62a2f477d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timestamp of the first image we receive.  <a href="#acfe9cb9b263e8746c2a17b62a2f477d9"></a><br/></td></tr>
<tr class="memitem:a94adf693a12b6434fb5012d47ec984a7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a94adf693a12b6434fb5012d47ec984a7">lastImageTime</a></td></tr>
<tr class="memdesc:a94adf693a12b6434fb5012d47ec984a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time at which we last received an image, so we know when images have stopped arriving.  <a href="#a94adf693a12b6434fb5012d47ec984a7"></a><br/></td></tr>
<tr class="memitem:aa1c5bbbf15ea84cdf174c4b9dee32ede"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#aa1c5bbbf15ea84cdf174c4b9dee32ede">filehandles</a></td></tr>
<tr class="memdesc:aa1c5bbbf15ea84cdf174c4b9dee32ede"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filehandles we will write the data to.  <a href="#aa1c5bbbf15ea84cdf174c4b9dee32ede"></a><br/></td></tr>
<tr class="memitem:ae9b6dc3c6391f1dd3fd9b66a32422baf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#ae9b6dc3c6391f1dd3fd9b66a32422baf">filenames</a></td></tr>
<tr class="memdesc:ae9b6dc3c6391f1dd3fd9b66a32422baf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filenames for same.  <a href="#ae9b6dc3c6391f1dd3fd9b66a32422baf"></a><br/></td></tr>
<tr class="memitem:a93d41c0ef69446eceda7b8d153233d5b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a93d41c0ef69446eceda7b8d153233d5b">fileLocks</a></td></tr>
<tr class="memdesc:a93d41c0ef69446eceda7b8d153233d5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock on writing to each file.  <a href="#a93d41c0ef69446eceda7b8d153233d5b"></a><br/></td></tr>
<tr class="memitem:a40a0c4b0f1a48d14d16c792b8fa3b948"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a40a0c4b0f1a48d14d16c792b8fa3b948">extendedBytes</a></td></tr>
<tr class="memdesc:a40a0c4b0f1a48d14d16c792b8fa3b948"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of one image's worth of metadata in the extended header.  <a href="#a40a0c4b0f1a48d14d16c792b8fa3b948"></a><br/></td></tr>
<tr class="memitem:a9fa4de9a06b200583ee9e1c865119112"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a9fa4de9a06b200583ee9e1c865119112">headers</a></td></tr>
<tr class="memdesc:a9fa4de9a06b200583ee9e1c865119112"><td class="mdescLeft">&#160;</td><td class="mdescRight">MRC header objects for each file.  <a href="#a9fa4de9a06b200583ee9e1c865119112"></a><br/></td></tr>
<tr class="memitem:a581bd4f9e420c9a18d30360517f2794d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a581bd4f9e420c9a18d30360517f2794d">imagesReceived</a></td></tr>
<tr class="memdesc:a581bd4f9e420c9a18d30360517f2794d"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of how many images we've received, on a per-camera basis.  <a href="#a581bd4f9e420c9a18d30360517f2794d"></a><br/></td></tr>
<tr class="memitem:ac627ef363ec81e963d8750abb581c835"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#ac627ef363ec81e963d8750abb581c835">imagesKept</a></td></tr>
<tr class="memdesc:ac627ef363ec81e963d8750abb581c835"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of how many images we've written, on a per-camera basis.  <a href="#ac627ef363ec81e963d8750abb581c835"></a><br/></td></tr>
<tr class="memitem:a1620bee6f8533d87f82e9f2fd9b08cfe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a1620bee6f8533d87f82e9f2fd9b08cfe">lambdas</a></td></tr>
<tr class="memdesc:a1620bee6f8533d87f82e9f2fd9b08cfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of functions that receive image data and feed it into self.imagesReceived.  <a href="#a1620bee6f8533d87f82e9f2fd9b08cfe"></a><br/></td></tr>
<tr class="memitem:a5de5fb3bdba48be2935226a371df2f47"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a5de5fb3bdba48be2935226a371df2f47">minMaxVals</a></td></tr>
<tr class="memdesc:a5de5fb3bdba48be2935226a371df2f47"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of (min, max) tuples, on a per-camera basis, tracking the dimmest and brightest pixels.  <a href="#a5de5fb3bdba48be2935226a371df2f47"></a><br/></td></tr>
<tr class="memitem:a17bec4d7ac9d8d80dd1ad98c1d2479fd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a17bec4d7ac9d8d80dd1ad98c1d2479fd">shouldAbort</a></td></tr>
<tr class="memdesc:a17bec4d7ac9d8d80dd1ad98c1d2479fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if we should stop collecting data.  <a href="#a17bec4d7ac9d8d80dd1ad98c1d2479fd"></a><br/></td></tr>
<tr class="memitem:aa2a0f278ded5016bfaac929495263af8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#aa2a0f278ded5016bfaac929495263af8">amDone</a></td></tr>
<tr class="memdesc:aa2a0f278ded5016bfaac929495263af8"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if we are done collecting data.  <a href="#aa2a0f278ded5016bfaac929495263af8"></a><br/></td></tr>
<tr class="memitem:a163763d30afb048cc237ef1463cd6fd2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a163763d30afb048cc237ef1463cd6fd2"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#a163763d30afb048cc237ef1463cd6fd2">imageQueue</a></td></tr>
<tr class="memdesc:a163763d30afb048cc237ef1463cd6fd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue of (camera index, image data, timestamp) tuples for images that need to be saved. <br/></td></tr>
<tr class="memitem:ae9105f11e0f5fad5bf7b03bef44f8629"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classexperiment_1_1data_saver_1_1_data_saver.html#ae9105f11e0f5fad5bf7b03bef44f8629">statusThread</a></td></tr>
<tr class="memdesc:ae9105f11e0f5fad5bf7b03bef44f8629"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thread that handles updating the UI.  <a href="#ae9105f11e0f5fad5bf7b03bef44f8629"></a><br/></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This class simply records all data received during an experiment and saves it to disk in MRC format. </p>
</div><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a4684b9c9a06247e298697b4a7718605a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def experiment.dataSaver.DataSaver.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cameras</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>numReps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cameraToImagesPerRep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cameraToIgnoredImageIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>runThread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>savePath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pixelSizeZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>titles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cameras</td><td>List of CameraHandler instances for the cameras that will be generating images </td></tr>
    <tr><td class="paramname">numReps</td><td>How many times the experiment will be repeated. </td></tr>
    <tr><td class="paramname">cameraToImagesPerRep</td><td>Maps camera handlers to how many images to expect for that camera in a single repeat of the experiment. </td></tr>
    <tr><td class="paramname">cameraToIgnoredImageIndices</td><td>Maps camera handlers to indices of images that we don't actually want to keep. </td></tr>
    <tr><td class="paramname">runThread</td><td>Thread that is executing the experiment. When it exits, we know to stop expecting more images. </td></tr>
    <tr><td class="paramname">savePath</td><td>Path to save the incoming data to. </td></tr>
    <tr><td class="paramname">pixelSizeZ</td><td>Size of the Z "pixel" (i.e. distance between Z slices). </td></tr>
    <tr><td class="paramname">titles</td><td>List of strings to insert into the MRC file's header. Per the file format, each string can be up to 80 characters long and there can be up to 10 of them. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2>Member Function Documentation</h2>
<a class="anchor" id="a39e7bd46b7ae26a2bf2b64fb22719bc4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def experiment.dataSaver.DataSaver.cleanup </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean up once saving is completed. </p>

</div>
</div>
<a class="anchor" id="ac898ee9fbc4511a5e8bfb76bac353dfc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def experiment.dataSaver.DataSaver.executeAndSave </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wait for the runThread to finish, then wait a bit longer in case some images are laggardly, before we close our filehandles. </p>

</div>
</div>
<a class="anchor" id="a4b340b98619f048a957e5ed0188cb90f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def experiment.dataSaver.DataSaver.getFilenames </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a list of the filenames we are writing to. </p>

</div>
</div>
<a class="anchor" id="a2189967aa67a999bb46a7883af6d51ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def experiment.dataSaver.DataSaver.onAbort </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>User aborted; stop saving data. </p>

</div>
</div>
<a class="anchor" id="a33577b9366395c6aefcad609ad8d2b4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def experiment.dataSaver.DataSaver.onImage </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cameraIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>imageData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive new data, and add it to the queue. </p>

</div>
</div>
<a class="anchor" id="acceb6f5fe6708950dbd7886658814ccf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def experiment.dataSaver.DataSaver.saveData </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Continually poll our imageQueue and save data to the file. </p>

</div>
</div>
<a class="anchor" id="afa6d3a6545aae9b95d6e947e32de0c02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def experiment.dataSaver.DataSaver.startCollecting </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subscribe to the new-camera-image events for the cameras we care about. </p>
<p>Save the functions we generate for handling the subscriptions, so we can unsubscribe later. Initialize self.minMaxVals. Start our status-update thread. </p>

</div>
</div>
<a class="anchor" id="a49e01a4c87b07ac71cb9c47e50c7d8e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def experiment.dataSaver.DataSaver.writeImage </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cameraIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>imageData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a single image to the file. </p>

</div>
</div>
<h2>Member Data Documentation</h2>
<a class="anchor" id="aa2a0f278ded5016bfaac929495263af8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.amDone</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>True if we are done collecting data. </p>

</div>
</div>
<a class="anchor" id="ac19ac0a539885106a5817c2612a3e29e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.cameraToImagesKeptPerRep</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maps camera handlers to total images kept per rep. </p>

</div>
</div>
<a class="anchor" id="abcfc9538377e03b0f95f3f0a2f382d84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.cameraToIndex</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We need to establish a consistent ordering for cameras so that each image gets stored in the correct part of the file. </p>
<p>This maps camera handlers to indices. </p>

</div>
</div>
<a class="anchor" id="a8e0d45a680b312d5e0d245b09b340a69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.doNeedToSplitFiles</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Whether or not we need to split the data into multiple files. </p>

</div>
</div>
<a class="anchor" id="a40a0c4b0f1a48d14d16c792b8fa3b948"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.extendedBytes</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of one image's worth of metadata in the extended header. </p>
<p>We store 1 4-byte float per image. </p>

</div>
</div>
<a class="anchor" id="aa1c5bbbf15ea84cdf174c4b9dee32ede"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.filehandles</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Filehandles we will write the data to. </p>

</div>
</div>
<a class="anchor" id="a93d41c0ef69446eceda7b8d153233d5b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.fileLocks</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lock on writing to each file. </p>

</div>
</div>
<a class="anchor" id="ae9b6dc3c6391f1dd3fd9b66a32422baf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.filenames</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Filenames for same. </p>

</div>
</div>
<a class="anchor" id="acfe9cb9b263e8746c2a17b62a2f477d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.firstTimestamp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Timestamp of the first image we receive. </p>
<p>We need this so we can rebase the timestamps of images to to be relative to the beginning of the experiment &ndash; Python timestamps can't be stored directly as 32-bit floating points without losing a lot of precision. And we want to store image timestamps in the extended header, to help us identify when frames get dropped. </p>

</div>
</div>
<a class="anchor" id="a9fa4de9a06b200583ee9e1c865119112"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.headers</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>MRC header objects for each file. </p>

</div>
</div>
<a class="anchor" id="a06c9c9250532566df07fea83be416b77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.imageBytes</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of bytes to allocate for each image in the file. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>Assuming unsigned 16-bit integer here. </dd></dl>

</div>
</div>
<a class="anchor" id="ac627ef363ec81e963d8750abb581c835"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.imagesKept</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List of how many images we've written, on a per-camera basis. </p>

</div>
</div>
<a class="anchor" id="a581bd4f9e420c9a18d30360517f2794d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.imagesReceived</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List of how many images we've received, on a per-camera basis. </p>

</div>
</div>
<a class="anchor" id="aee88e2dddd15fd61e6826e082f89a868"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.indexToCamera</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maps ints to cameras; the ints represent the order in which the images are stored. </p>

</div>
</div>
<a class="anchor" id="a1620bee6f8533d87f82e9f2fd9b08cfe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.lambdas</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List of functions that receive image data and feed it into self.imagesReceived. </p>

</div>
</div>
<a class="anchor" id="a94adf693a12b6434fb5012d47ec984a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.lastImageTime</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Time at which we last received an image, so we know when images have stopped arriving. </p>

</div>
</div>
<a class="anchor" id="af09fa749c99a7ebe23cd2bdbb8df0a13"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.maxFilesize</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum size, in megabytes, of each file generated. </p>
<p>If the experiment data exceeds this, then a new file will be opened, and each file will have a suffix appended to it (e.g. ".001", ".002", etc.). This is not a precise cap, since it only considers the amount of space allocated to image data &ndash; not the header or extended header. The default of a googol megabytes ought to be enough to avoid splitting files if no cap is specified. :) </p>

</div>
</div>
<a class="anchor" id="a8d514ddedfebf87322df7c11bcf2de74"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.maxImagesPerRep</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We need this for the upper bound on the array of data we write. </p>

</div>
</div>
<a class="anchor" id="a20ca42c4a45d7d9fae993d0de7f6f294"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.maxRepsPerFile</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of timepoints per file, based on the above and self.maxFilesize. </p>

</div>
</div>
<a class="anchor" id="a5de5fb3bdba48be2935226a371df2f47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.minMaxVals</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List of (min, max) tuples, on a per-camera basis, tracking the dimmest and brightest pixels. </p>

</div>
</div>
<a class="anchor" id="a17bec4d7ac9d8d80dd1ad98c1d2479fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.shouldAbort</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>True if we should stop collecting data. </p>

</div>
</div>
<a class="anchor" id="ae9105f11e0f5fad5bf7b03bef44f8629"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">experiment.dataSaver.DataSaver.statusThread</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Thread that handles updating the UI. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>experiment/dataSaver.py</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Feb 3 2014 14:02:37 for OMX Cockpit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
